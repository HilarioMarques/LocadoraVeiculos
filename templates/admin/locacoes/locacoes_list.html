{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
    <h2 class="mb-4">Locações</h2>

    <a href="/admin/locacoes/nova" class="btn btn-primary mb-3">Nova Locação</a>

    <table class="table table-hover table-bordered">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Veículo</th>
                <th>Início</th>
                <th>Fim</th>
                <th>Status</th>
                <th>Valor</th>
                <th>Ações</th>
            </tr>
        </thead>

        <tbody>
            {% for loc in locacoes %}
            <tr>
                <td>{{ loc.id }}</td>
                <td>{{ loc.usuario.nome }}</td>
                <td>{{ loc.veiculo.modelo }}</td>
                <td>{{ loc.data_inicio.strftime("%d/%m/%Y") }}</td>
                <td>{{ loc.data_fim.strftime("%d/%m/%Y") }}</td>
                <td>{{ loc.status }}</td>
                <td>R$ {{ loc.valor_total }}</td>
                <td>
                    {% if loc.status == "confirmada" or loc.status == "ativa" %}
                    
                    <form action="{{ url_for('finalizar_locacao', id=loc.id) }}" 
                          method="POST" 
                          style="display:inline-block;"
                          onsubmit="return confirm('Finalizar esta locação e liberar o veículo?');">
                        <button class="btn btn-success btn-sm">Finalizar</button>
                    </form>

                    <form action="/admin/locacoes/{{ loc.id }}/cancelar" method="POST" style="display:inline-block;">
                        <button class="btn btn-danger btn-sm">Cancelar</button>
                    </form>
                    
                    {% else %}
                        <span class="text-muted">—</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>

</div>

{% endblock %}
